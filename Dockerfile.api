# Define build argument for the base image tag
ARG TAG=latest

# Stage 1: Build stage with dynamically tagged base Dockerfile
FROM syncsoftco/hubitat-lock-manager:${TAG}

# Stage 2: Final image with Tailscale and Python application
FROM tailscale/tailscale:latest

# Copy Python installation from the builder stage
COPY --from=builder /usr/local /usr/local

# Set the ENTRYPOINT to launch the Python script
ENTRYPOINT ["python", "-m", "hubitat_lock_manager.api_launcher"]
